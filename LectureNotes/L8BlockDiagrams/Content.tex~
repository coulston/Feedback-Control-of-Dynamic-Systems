\usetikzlibrary{patterns}
\usepackage{framed}
\usetikzlibrary{decorations.pathmorphing}
\mode<presentation>
{
  \usetheme{CambridgeUS}
  \usecolortheme{whale}
  \usecolortheme{lily}

  \setbeamercovered{transparent}
  \usefonttheme[onlymath]{serif}
}

\title[Block Diagrams] % (optional, use only with long paper titles)
{EGGN307: Block Diagrams\license}

\subtitle
{} % (optional)

\author% (optional, use only with lots of authors)
{Tyrone Vincent}
%{T. Vincent\inst{1} \and S.~Another\inst{2}}
% - Use the \inst{?} command only if the authors have different
%   affiliation.

\institute[CSM] % (optional, but mostly needed)
{Division of Engineering\\
  Colorado School of Mines}
% - Use the \inst command only if there are several affiliations.
% - Keep it simple, no one is interested in your street address.

\date % (optional)
{Lecture 11}



% If you have a file called "university-logo-filename.xxx", where xxx
% is a graphic format that can be processed by latex or pdflatex,
% resp., then you can add a logo as follows:

%\pgfdeclareimage[height=1.1cm]{university-logo}{UniversityLogo}
%\logo{\pgfuseimage{university-logo}}



% Delete this, if you do not want the table of contents to pop up at
% the beginning of each subsection:
%\AtBeginSection[]
%{
%  \begin{frame}<beamer>{Outline}
%    \tableofcontents[currentsection,currentsubsection]
%  \end{frame}
%}


% If you wish to uncover everything in a step-wise fashion, uncomment
% the following command:

%\beamerdefaultoverlayspecification{<+->}


\begin{document}

\begin{frame}
  \titlepage
\end{frame}

\mode<article>{
\maketitle
\tableofcontents
}

\section{Block Diagram Elements}

\begin{frame}{Block Diagram Elements}
\begin{itemize}
\item Block diagrams are graphical representations of algebraic equations
\end{itemize}
\begin{center}
\input{figures/systemblock.tex}\hspace{0.5in}\input{figures/summer.tex}
\end{center}
\end{frame}

\subsection{Block Diagram Simplifications}
\begin{frame}{Block Diagram Simplifications:}{Systems in Series}
\begin{itemize}
\item Systems that are in series or cascade can be combined by multiplying
\end{itemize}
\begin{center}
\input{figures/cascade.tex}
\end{center}
\end{frame}

\begin{frame}{Block Diagram Simplifications:}{Systems in Parallel}

\begin{itemize}
\item Systems in parallel can be combined by adding
\end{itemize}
\begin{center}
\resizebox{9cm}{!}{\input{figures/parallel.tex}}
\end{center}
\end{frame}

\begin{frame}{Block Diagram Simplifications:}{Systems in Feedback}
\begin{center}
\input{figures/feedback.tex}
\end{center}
\end{frame}
Eliminating $E(s)$:
\begin{align*}
Y(s) &= G(s)\left(R(s) - H(s)Y(s)\right) \\
& = G(s)R(s)  - G(s)H(s)Y(s)
\end{align*}
Solving for $Y(s)$:
\begin{align*}
Y(s) + G(s)H(s)Y(s) &= G(s)R(s)\\
(1+G(s)H(s))Y(s) & = G(s) R(s) \\
Y(s) & = \frac{G(s)}{1+G(s)H(s)}R(s)
\end{align*}

We will use this simplification often in this course.
\begin{frame}{Block Diagram Simplifications:}{Feedback Simplification}
\[
\boxed{Y(s) = \frac{G(s)}{1+G(s)H(s)}R(s)}
\]
\begin{center}
\input{figures/feedback2.tex}
\end{center}
\end{frame}

\subsection{Example}

\begin{frame}{Example 1}
\begin{itemize}
\item Simplify the following block diagram. All variables are functions of s.
\end{itemize}
\begin{center}
\input{figures/blockdiagramexample1.tex}
\end{center}
\end{frame}

\begin{frame}{Example 1:}{Step 1}
\begin{itemize}
\item Combine systems in parallel
\end{itemize}
\begin{center}
\input{figures/blockdiagramexample1simp1.tex}
\end{center}
\end{frame}

\begin{frame}{Example 1:}{Steps 2 and 3}
\begin{itemize}
\item Combine feedback systems
\item Combine systems in series
\end{itemize}
\begin{center}
\input{figures/blockdiagramexample1simp2.tex}
\end{center}
\end{frame}

\section{Other Manipulations}

\begin{frame}{Untangling Loops}
\begin{itemize}
\item Sometimes, loops interfere with each other
\end{itemize}
\begin{center}
\input{figures/blockdiagramexample2.tex}
\end{center}
\end{frame}

\subsection{Moving Elements}

\begin{frame}{Moving Summers}
\begin{itemize}
\item Summing can be done in any order
\end{itemize}
\begin{center}
\input{figures/movesummer.tex}
\end{center}
\end{frame}

\begin{frame}{Moving Pick-off points}
\begin{itemize}
\item Pick-off points can be taken anywhere on a line
\end{itemize}
\begin{center}
\input{figures/movepickoff.tex}
\end{center}
\end{frame}

\begin{frame}{Moving Pick-off points around blocks}
\begin{itemize}
\item Pick-off points can be moved around a block by adding blocks
\end{itemize}
\begin{center}
\input{figures/movepickoffaroundblock.tex}
\end{center}
\end{frame}

\subsection{Example}

\begin{frame}{Example 2}
\begin{itemize}
\item Let's return to this example
\end{itemize}
\begin{center}
\input{figures/blockdiagramexample2.tex}
\end{center}
\end{frame}

\begin{frame}{Example 2:}{Equivalent Diagram}
\begin{center}
\input{figures/blockdiagramexample2equiv.tex}
\end{center}
\end{frame}

\begin{frame}{Example 2:}{Simplified}
\begin{center}
\input{figures/blockdiagramexample2simp.tex}
\end{center}
\[
\frac{Y(s)}{R(s)} = \frac{(H+1)(G_{1}+1)}{1+G_{2}G_{1}}
\]
\end{frame}

\begin{frame}{Backup Plan}
\begin{itemize}
\item If you ever get stuck - just convert back to algebra relationships and solve by hand
\item Add variable names at inputs to blocks
\item Write equations for all variables, solve for transfer function
\end{itemize}
\begin{center}
\input{figures/blockdiagramexample2named.tex}
\end{center}

The equations are
\begin{align*}
A &= R+ HR - G_{2}B \\
B & = G_{1}A\\
Y & = A + G_{1}A
\end{align*}
\end{frame}
Eliminate $B$:
\begin{align*}
A &= R+ HR - G_{2}G_{1}A \\
A & = \frac{1+H}{1+G_{2}G_{1}}R
\end{align*}
Eliminate $A$:
\begin{align*}
Y &=  \frac{1+H}{1+G_{2}G_{1}}R + G_{1} \frac{1+H}{1+G_{2}G_{1}}R\\
 & =  \frac{(1+H)(1+G_{1})}{1+G_{2}G_{1}}R
\end{align*}

\section{Quiz Yourself}

\subsection{Questions}


\begin{enumerate}
\setlength{\itemsep}{5pt}
\setlength{\parskip}{0pt}
\setlength{\parsep}{0pt}
\item Simplify the following block diagram
\begin{center}
\input{quizfigures/blockdiagramexample1.tex}
\end{center}
\item Simplify the following block diagram
\begin{center}
\input{quizfigures/blockdiagramexample2.tex}
\end{center}

\end{enumerate}
\pagebreak

\subsection{Solutions}
\begin{enumerate}
\setlength{\itemsep}{5pt}
\setlength{\parskip}{0pt}
\setlength{\parsep}{0pt}
\item \rule{0pt}{12pt}\\
\begin{center}
\includegraphics[width=5in]{quizfigures/1soln}
\end{center}
\pagebreak
\item \rule{0pt}{12pt}\\
\begin{center}
\includegraphics[width=5in]{quizfigures/2asoln}\\
\includegraphics[width=5in]{quizfigures/2bsoln}
\end{center}
\end{enumerate}




\end{document}