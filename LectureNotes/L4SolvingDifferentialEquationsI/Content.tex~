\usetikzlibrary{patterns}
\usepackage{framed}
\usetikzlibrary{decorations.pathmorphing}
\mode<presentation>
{
  \usetheme{CambridgeUS}
  \usecolortheme{whale}
  \usecolortheme{lily}

  \setbeamercovered{transparent}
  \usefonttheme[onlymath]{serif}
}

\title[Laplace and DEQs] % (optional, use only with long paper titles)
{EGGN307: Solving Differential Equations using Laplace Transforms\license}

\subtitle
{} % (optional)

\author% (optional, use only with lots of authors)
{Tyrone Vincent}
%{T. Vincent\inst{1} \and S.~Another\inst{2}}
% - Use the \inst{?} command only if the authors have different
%   affiliation.

\institute[CSM] % (optional, but mostly needed)
{Division of Engineering\\
  Colorado School of Mines}
% - Use the \inst command only if there are several affiliations.
% - Keep it simple, no one is interested in your street address.

\date % (optional)
{Lecture 5}



% If you have a file called "university-logo-filename.xxx", where xxx
% is a graphic format that can be processed by latex or pdflatex,
% resp., then you can add a logo as follows:

%\pgfdeclareimage[height=1.1cm]{university-logo}{UniversityLogo}
%\logo{\pgfuseimage{university-logo}}



% Delete this, if you do not want the table of contents to pop up at
% the beginning of each subsection:
%\AtBeginSection[]
%{
%  \begin{frame}<beamer>{Outline}
%    \tableofcontents[currentsection,currentsubsection]
%  \end{frame}
%}


% If you wish to uncover everything in a step-wise fashion, uncomment
% the following command:

%\beamerdefaultoverlayspecification{<+->}


\begin{document}

\begin{frame}
  \titlepage
\end{frame}

\mode<article>{
\maketitle
\tableofcontents
}

\section{Finding Solutions to Differential Equations}

As promised, we can now solve differential equations using Laplace
Transforms. What we do is transform the differential equation into an
algebratic relation using a Laplace Transform, solve for the Laplace
Transform of the solution, then use inverse Laplace Transforms to bring the
solution back into the time domain. The most important property of the
Laplace transform in this case is the differentiation property:%
\begin{frame}{Laplace Transform: Differentiation Property}
\begin{eqnarray*}
\mathcal{L}\left\{ \frac{d}{dt}f(t)\right\} &=&sF(s)-f(0^{-}), \\
\mathcal{L}\left\{ \frac{d^{2}}{dt^{2}}f(t)\right\} &=&s\mathcal{L}\left\{ 
\frac{d}{dt}f(t)\right\} -\frac{df}{dt}(0^{-}), \\
&=&s^{2}F(s)-sf(0^{-})-\frac{df}{dt}(0^{-}), \\
\mathcal{L}\left\{ \frac{d^{n}}{dt^{n}}f(t)\right\} &=&s^{n}F(s)-s^{n-1}f(0^{-})-
\\
&&\cdots -sf^{(n-2)}(0^{-})-f^{(n-1)}(0^{-}).
\end{eqnarray*}
\end{frame}
A good starting point to remember this is: if the initial conditions are
zero, we can replace $n^{th}$ order differentiation with $s^{n}.$ Note that
because we have defined the Laplace Transform with the lower limit of
integration zero, we must always take the starting time as $0,$ which is no
problem for linear constant coefficient differential equations.

\begin{example}
\begin{frame}
Here is a simple differential equation:%
\begin{equation*}
\frac{dx}{dt}=1\quad t\geq 0.
\end{equation*}%
What is $x(t)?$ \end{frame} Since the functions are equal on the left and right, the
Laplace Transforms will be equal: 
\begin{equation*}
sX(s)-x(0^{-})=\frac{1}{s}.
\end{equation*}%
Solve for $X(s):$%
\begin{equation*}
X(s)=\frac{1}{s^{2}}+\frac{x(0^{-})}{s}.
\end{equation*}%
We recognize the Laplace Transforms on the right hand side, resulting in the solution%
\begin{equation*}
x(t)=t+x(0^{-})\quad t\geq 0.
\end{equation*}
\end{example}

\begin{example}
Let's find the trajectory for a mass spring damper system subject to an initial condition and an applied force.
\begin{frame}{Mass-spring-damper System}
\begin{minipage}{2.6in}
At time $t=0$, this system is at position $x=0$, but with an initial velocity of $1$ m/s. Beginning at this time, the force $f(t)=e^{-3t}$ is applied. Find $x(t)$ for $t\geq 0$.
\end{minipage}
\begin{minipage}{2in}
\input{figures/massspringdamper.tex}
\end{minipage}
\end{frame}\vspace{.1in}

We can state this problem as solving 
\begin{equation*}
\ddot{x}+3\dot{x}+2x=e^{-3t}\qquad x(0)=0,\text{ }\dot{x}(0)=1.
\end{equation*}%
Taking the Laplace Transform of both sides:%
\begin{eqnarray*}
\left( s^{2}X(s)-1\right) +3 sX(s) +2X(s) &=&\frac{1}{s+3}, \\
\left( s^{2}+3s+2\right) X(s) &=&\frac{1}{s+3}+1 = \frac{s+4}{s+3}, \\
X(s) &=&\frac{s+4}{ (s^{2}+3s+2)(s+3) },\\
&=&\frac{s+4}{s^{3}+6s^{2}+11s+6 }.
\end{eqnarray*}%
This the Laplace Transform of the trajectory, but what is the inverse Laplace Transfom? We need to break this rational function up into parts that we can recognize by using partial fraction expansion. This is covered in the next section.
\end{example}


\subsection{Partial Fraction Expansion}
\begin{frame}{Partial Fraction Expansion}
We can use a partial fraction expansion to break a rational function up into
easily recognizable parts. For example, we can determine from observation
that the inverse Laplace transform of 
\begin{equation*}
X(s)=\frac{3}{s-5}
\end{equation*}
is given by 
\begin{equation*}
x(t)=3e^{5t}.
\end{equation*}
\end{frame}
The partial fraction expansion method is best described using an example,
but there are several possible different cases.

\subsubsection{Partial fraction expansion - simple real poles}
\begin{example}
\begin{frame}{Partial Fraction Expansion Example}
Find the inverse Laplace Transform of 
\begin{equation*}
X(s)=\frac{s+4}{s^{3}+6s^{2}+11s+6}.
\end{equation*}
\end{frame}
\textbf{Solution:} In order to apply the partial fraction expansion, we must
first find the roots of the denominator, which are $-1,$ $-2,$ and $-3.$ We
can rewrite $X(s)$ as 
\begin{equation*}
X(s)=\frac{s+4}{(s+1)(s+2)(s+3)}.
\end{equation*}
Since all the roots are real and simple (not multiple) we look for a partial
fraction expansion of the form 
\begin{equation*}
X(s)=\frac{A}{s+1}+\frac{B}{s+2}+\frac{C}{s+3}.
\end{equation*}
All that is left is to find the values of the unknown coefficients $A,$ $B,$ 
$C,$which are called \emph{residues}. There are several ways to do this:

\begin{description}
\item[Method 1: Equating coefficients]  Since we need the two
representations to be equal, we have 
\begin{frame}{Equating Coefficients}
\begin{equation*}
\frac{s+4}{(s+1)(s+2)(s+3)}=\frac{A}{s+1}+\frac{B}{s+2}+\frac{C}{s+3}.
\end{equation*}
\end{frame}
Putting the right hand side under a common denominator, 
\begin{equation*}
\frac{s+4}{(s+1)(s+2)(s+3)}=\frac{A(s^{2}+5s+6)+B(s^{2}+4s+3)+C(s^{2}+3s+2)}{%
(s+1)(s+2)(s+3)}.
\end{equation*}
Equating coefficients gives us the three equations 
\begin{eqnarray*}
A+B+C &=&0, \\
5A+4B+3C &=&1, \\
6A+3B+2C &=&4.
\end{eqnarray*}

Solving for $A,$ $B,$ $C:$%
\begin{eqnarray*}
A &=&1.5, \\
B &=&-2, \\
C &=&0.5.
\end{eqnarray*}
so 
\begin{equation*}
X(s)=\frac{1.5}{s+1}+\frac{-2}{s+2}+\frac{0.5}{s+3}.
\end{equation*}
and we can easily find the inverse Laplace Transform as 
\begin{equation*}
x(t)=(1.5e^{-t}-2e^{-2t}+0.5e^{-3t})\step.
\end{equation*}

\item[Method 2: Finding residues directly]  We again start with the
funamental desired equality 
\begin{frame}{Finding Residuals Directly}
\begin{equation*}
X(s)=\frac{s+4}{(s+1)(s+2)(s+3)}=\frac{A}{s+1}+\frac{B}{s+2}+\frac{C}{s+3}.
\end{equation*}
\end{frame}
Now, if we multiply both sides by $(s+1)$, we get 
\begin{equation*}
(s+1)X(s)=\frac{s+4}{(s+2)(s+3)}=A+\frac{(s+1)B}{s+2}+\frac{(s+1)C}{s+3}.
\end{equation*}
Letting $s=-1,$%
\begin{equation*}
\left. (s+1)X(s)\right| _{s=-1}=\frac{3}{1\cdot 2}=A+0+0.
\end{equation*}
We have found an equation for $A!$ Clearly, $A=1.5,$ as we saw before. In
general, to find the residue of a simple pole $p_{i}$, multiply the rational
function by $(s-p_{i})$ and let $s=p_{i},$ the result is the residue. We
find 
\begin{eqnarray*}
B &=&\left. (s+2)X(s)\right| _{s=-2}=\frac{2}{(-1)(1)}=-2, \\
C &=&\left. (s+2)X(s)\right| _{s=-3}=\frac{1}{(-2)(-1)}=0.5.
\end{eqnarray*}
as expected.
\end{description}
\end{example}
\begin{frame}{Mass Spring Damper Response}
\begin{center}\resizebox{8cm}{!}{\input{mass_spring_damper}}\end{center} 
\end{frame}
\subsubsection{Partial fraction expansion - simple complex poles}

Fundamentally, simple complex poles can be dealt with in the same way as
simple real poles. However, it is useful to keep complex conjuate poles
together

\begin{example}
\begin{frame}{Simple Complex Poles}
Find the inverse Laplace Transform of 
\begin{equation*}
F(s)=\frac{3s^{2}+10s+10}{s^{3}+4s^{2}+6s+4}.
\end{equation*}
\end{frame}
In this case, the roots of the denominator are $-2,$ $-1+j,$ $-1-j.$ We
could break this up into three terms as before, but it is easier to keep the
complex conjugate poles together, so we want to find the following
expansion: 
\begin{equation*}
F(s)=\frac{A}{s+2}+\frac{Bs+C}{s^{2}+2s+2}.
\end{equation*}
The complex conjugate term must have $Bs+C$ in the numerator in order to be
assured of a solution. We can find $A$ using the direct residue method: 
\begin{equation*}
A=\left. (s+2)F(s)\right| _{s=-2}=\left. \frac{3s^{2}+10s+10}{s^{2}+2s+2}%
\right| _{s=-2}=\frac{12-20+10}{4-4+2}=\frac{2}{2}=1,
\end{equation*}
while $B$ and $C$ can be found by equating coefficients, or by our third method of
finding residues:

\begin{description}
\item[Method 3: Equating coefficients for certain values of $s$]  So far, we
have
\begin{equation*}
F(s)=\frac{3s^{2}+10s+10}{s^{3}+4s^{2}+6s+4}=\frac{1}{s+2}+\frac{Bs+C}{%
s^{2}+2s+2}.
\end{equation*}
Since this equaltiy must hold for all values of $s,$ it must hold for
particular values of $s$ that we choose. If $s=0$ is not a pole, then this
is a good choice to plug into both sides. We get 
\begin{eqnarray*}
\frac{3\left( 0\right) ^{2}+10\left( 0\right) +10}{\left( 0\right)
^{3}+4\left( 0\right) ^{2}+6\left( 0\right) +4} &=&\frac{1}{0+2}+\frac{%
B\left( 0\right) +C}{\left( 0\right) ^{2}+2\left( 0\right) +2}, \\
\frac{10}{4} &=&\frac{1}{2}+\frac{C}{2}, \\
4 &=&C,
\end{eqnarray*}
giving us $C$ dircetly. Plugging $s=1$ into both sides, we get 
\begin{eqnarray*}
\frac{3\left( 1\right) ^{2}+10\left( 1\right) +10}{\left( 1\right)
^{3}+4\left( 1\right) ^{2}+6\left( 1\right) +4} &=&\frac{1}{1+2}+\frac{%
B\left( 1\right) +C}{\left( 1\right) ^{2}+2\left( 1\right) +2}, \\
\frac{23}{15} &=&\frac{1}{3}+\frac{B+C}{5}, \\
6 &=&B+C,
\end{eqnarray*}
or $B=6-4=2.$
\end{description}

This gives us 
\begin{equation*}
F(s)=\frac{1}{s+2}+\frac{2s+4}{s^{2}+2s+2}.
\end{equation*}
The final step is to find the inverse Laplace Transform. The first term is
easy, as we recognize it as an exponential. For the second term, we need to
look at the transform pairs that involve complex conjugate roots:

\begin{center}
\begin{tabular}{lll}
\rule{0pt}{12pt}sine & $\sin \omega t$ & $\frac{\omega }{s^{2}+\omega ^{2}}$ \\ 
\rule{0pt}{12pt}cosine & $\cos \omega t$ & $\frac{s}{s^{2}+\omega ^{2}}$ \\ 
\rule{0pt}{12pt}damped sine & $e^{-at}\sin \omega t$ & $\frac{\omega }{\left( s+a\right)
^{2}+\omega ^{2}}$ \\ 
\rule{0pt}{12pt}damped cosine & $e^{-at}\cos \omega t$ & $\frac{s+a}{\left( s+a\right)
^{2}+\omega ^{2}}$%
\end{tabular}
\end{center}

First, we should put the denominator into the form $(s+a)^{2}+\omega ^{2}$
by completing the square 
\begin{eqnarray*}
s^{2}+2s+2 &=&s^{2}+2s+1+1, \\
&=&\left( s+1\right) ^{2}+1.
\end{eqnarray*}
Then, we need to put the numerator into the correct form, 
\begin{equation*}
2s+4=2(s+1)+2
\end{equation*}
so we have 
\begin{equation*}
\frac{2s+4}{(s+1)^{2}+1}=2\frac{(s+1)}{(s+1)^{2}+1}+2\frac{1}{(s+1)^{2}+1},
\end{equation*}
or 
\begin{equation*}
F(s)=\frac{1}{s+2}+2\frac{(s+1)}{(s+1)^{2}+1}+2\frac{1}{(s+1)^{2}+1},
\end{equation*}
and 
\begin{equation*}
f(t)=(e^{-2t}+2e^{-t}\cos (t)+2e^{-t}\sin (t))\step,
\end{equation*}
by inspection.
\end{example}

%\subsubsection{Partial fraction expansion - numerator of equal or higher
%order than denominator}
%
%When the numerator is of equal or higher order than the denominator, for
%example 
%\begin{equation*}
%F(s)=\frac{s^{3}+2s+1}{s^{2}+2s}
%\end{equation*}
%then before we can find the partial fraction expansion, we must divide out
%the polynominal and constant terms using long division. for example: 
%\begin{eqnarray*}
%\frac{s^{3}+2s+1}{s^{2}+2s} &=&s+\frac{-2s^{2}+2s+1}{s^{2}+2s} \\
%\frac{-2s^{2}+2s+1}{s^{2}+2s} &=&-2+\frac{6s+1}{s^{2}+2s}
%\end{eqnarray*}
%So we have 
%\begin{equation*}
%F(s)=s-2+\frac{6s+1}{s^{2}+2s}
%\end{equation*}
%and we can find the partial fraction expansion of $\frac{6s+1}{s^{2}+2s},$
%the constant and polynomial terms are impulses and derivatives of impulses.
%

\section{Quiz Yourself}

\subsection{Questions}


\begin{enumerate}
\setlength{\itemsep}{5pt}
\setlength{\parskip}{0pt}
\setlength{\parsep}{0pt}
\item Find the Inverse Laplace Transform of the following functions
\begin{enumerate}
\setlength{\itemsep}{5pt}
\setlength{\parskip}{0pt}
\setlength{\parsep}{0pt}
\item $F(s) = \frac{3s+1}{s(s+1)(s+2)}$
\item $F(s) = \frac{3s+1}{s(s^{2}+4s+4)}$
\end{enumerate}
\end{enumerate}

\subsection{Solutions}
\begin{enumerate}
\setlength{\itemsep}{5pt}
\setlength{\parskip}{0pt}
\setlength{\parsep}{0pt}
\item \rule{0pt}{12pt}\\
\begin{enumerate}
\setlength{\itemsep}{5pt}
\setlength{\parskip}{0pt}
\setlength{\parsep}{0pt}
\item \rule{0pt}{12pt}\\
\begin{center}
\includegraphics[width=4in]{quizfigures/1asoln}
\end{center}
\item \rule{0pt}{12pt}\\
\begin{center}
\includegraphics[width=4in]{quizfigures/1bsoln}
\end{center}
\end{enumerate}

\end{enumerate}




\end{document}


