\mode<presentation>
{
  \usetheme{CambridgeUS}
  \usecolortheme{whale}
  \usecolortheme{lily}

  \setbeamercovered{transparent}
  \usefonttheme[onlymath]{serif}
}

\title[\HigherOrderResponseShortName] % (optional, use only with long paper titles)
{\course: \HigherOrderResponseName\license}

\subtitle
{Lecture \HigherOrderResponseNumber} % (optional)

\author[\instructorshort]% (optional, use only with lots of authors)
{\instructorlong\credits}
%{T. Vincent\inst{1} \and S.~Another\inst{2}}
% - Use the \inst{?} command only if the authors have different
%   affiliation.

\institute[\instituteshort] % (optional, but mostly needed)
{\institutelong}





\begin{document}

\begin{frame}
  \titlepage
\end{frame}

\mode<article>{
\maketitle
\tableofcontents
}

\section{Pre-requisite Material}
This lecture assumes that the reader is familiar with the following material:
\begin{itemize}
\item Lecture \FirstOrderResponseNumber:~\FirstOrderResponseName
\item Lecture \SecondOrderResponseNumber:~\SecondOrderResponseName
\end{itemize}

\section{Review of Last Two Lectures} 

We have obtained the following relationship between the poles of a first or second order system and the step response

\begin{frame}{Step Response Specifications}
\begin{center}
\resizebox{\textwidth}{!}{\begin{tabular} {c|c|c|c|c} 
System & System Parameters & Rise Time & Settling Time & \% Overshoot \\\hline
\rule{0pt}{14pt}$\frac{K\sigma}{s+\sigma}$ & $\sigma$ - pole magnitude &  $\tr = \treqone$ & $\ts = \tseqone$ & 0 \\[.05in]\hline
\rule{0pt}{26pt}$\frac{K\omega_{n}^{2}}{s^{2}+2\zeta\omega_{n} s +\omega_{n}^{2}}$ & $\begin{matrix} \zeta & \mbox{- damping ratio} \\
\omega_{n} & \mbox{- natural frequency} \\
\sigma = \zeta\omega_{n} & \mbox{- real part of poles} \end{matrix}$ &   $\tr = \treqtwo$ & $\ts = \tseqtwo$ & $\OSeq$ 
\end{tabular}}
\end{center}
\end{frame}

\subsection{Pole-Zero diagram}\label{sec:polezero}

In order to view the relative positions of the poles and zeros of a transfer function, we plot them in the complex plane with an 'X' marking the poles and a 'O' marking the zeros. The result is a pole-zero diagram (also called a pole-zero map).

\begin{frame}{Pole-Zero diagram}
\begin{center}
\begin{minipage}{2in}
\[
\small F(s) = \frac{s^{3} + 2s^{2} +2s}{s^{4}+8s^{3}+24s^{2}+32s+15}\\
\]
zeros: $-1+j,-1-j,0$\\
poles: $-3,-1,-2+j,-2-j$\vspace{.75in}\\
\end{minipage}
\begin{minipage}{2.6in}
\begin{center}
\includegraphics[width=2.6in]{figures/polezeroplot}
\end{center}
\end{minipage}
\end{center}
\end{frame}



\subsection{Qualitative Effect of Poles on System Response}

It is very common for both the system transfer function and the input to be represented as rational functions, for example
\[
G(s) = \frac{(s-z_{1})(s-z_{2})}{(s-p_{1})(s-p_{2})(s-p_{3})}\quad U(s) =  \frac{(s-\zeta_{1})}{(s-\eta_{1})(s-\eta_{2})}
\]
The system response, or in other words, the output of the system in response to this input, will be another rational function
\[
Y(s) = \frac{(s-z_{1})(s-z_{2})(s-\zeta_{1})}{(s-p_{1})(s-p_{2})(s-p_{3})(s-\eta_{1})(s-\eta_{2})}\
\] 
When we find the inverse Laplace Transform, we see that the partial fraction expansion will have terms representing the poles of the system, and the poles of the input 
\[
Y(s) = \frac{A}{s-p_{1}} + \frac{B}{s-p_{2}} + \frac{C}{s-p_{3}} + \frac{D}{s-\eta_{1}} + \frac{E}{s-\eta_{2}}
\]
This means once we know the poles of the system and input, we already know the types of functions that will appear in the output
\[
y(t) = Ae^{p_{1}t} + \cdots + Ee^{\eta_{2}t}
\]
Using the partial Laplace Transform Table

\begin{frame}
\begin{center}
\begin{tabular}{ll}
$e^{-\sigma t}\step(t)$ & $\frac{1}{s+\sigma}$ \\
\rule{0pt}{12pt} $e^{-at}\sin( \omega t)\step(t)$ & $\frac{\omega }{\left( s+a\right)
^{2}+\omega ^{2}}$ \\ 
\rule{0pt}{12pt} $e^{-at}\cos( \omega t)\step(t)$ & $\frac{s+a}{\left( s+a\right)
^{2}+\omega ^{2}}$%
\end{tabular}
\end{center}
\end{frame}
\noindent we can visualize the types of terms that occur from $e^{p_{i}t}$ when $p_{i}=-\sigma$ is real, or $e^{p_{j}t}+e^{p_{k}t}$ when $p_{j}$ and $p_{k}$ are complex conjugates $-a\pm j\omega$.

\begin{frame}{Pole map with responses}
\begin{center}
\includegraphics[width=3.5in]{figures/impulseresponseplot}\\<all>
(Conjugate poles not shown)
\end{center}
\end{frame}


The system response for higher order systems, or systems with zeros, can be complex and in general requires a case-by-case analysis. However, an approximate analysis is possible using the concept of {\em dominant poles}.

\section{Dominant Poles}
\subsection{The effect of extra poles}
Consider the following third order system
\[
G(s) = \frac{A}{(s^{2}+2\zeta\omega_{n}s+\omega_{n}^{2})(s+\alpha)}.
\]
This system has a pair of complex poles and a third real pole.

\begin{definition}
Given a rational transfer function, $G(s)$, the \underline{dominant poles} are the poles with real part closest to the origin.
\begin{center}
\input{Graphics/dominantpoles.tex}
\end{center}
\end{definition}

When all the other poles are much farther to the left than the dominant poles, we may be able to approximate the system response using only the dominant poles. 




\begin{example}
Consider the nominal system
\[
G_{\rm nom}(s) = \frac{2}{s^{2}+2s +2}
\]
We compare the step response of this system with the step response of the following two systems 
\[
G_{1}(s) = \frac{2}{(s^{2}+2s +2)}\frac{2}{(s+2)} \quad G_{2}(s) = \frac{2}{(s^{2}+2s +2)}\frac{10}{(s+10)}
\]
These three systems all have complex poles at $s=-1\pm j$. The ``nominal'' system has no third pole, while $G_{1}$ has a third pole at $s=-2$ and $G_{2}$ has a third pole at $s=-10$. The pole zero diagram for $G_{1}(s)$ and $G_{2}(s)$ are shown, along with the comparison of the step response to the nominal second order system.
\begin{frame}{Effect of extra pole on step response}
\begin{center}
\input{Graphics/extrapole.tex}
\end{center}
\end{frame}
\end{example}

We see that the effect of an extra pole is to slow down the response, but this effect is reduced as the pole moves to the left on the complex plane. We have the following rule of thumb:
\begin{center}
\framebox{Extra poles can be discarded if they are $\geq$ 10$\times$ the real part of the dominant poles}
\end{center}

\subsection{The effect of extra zeros}

If the system transfer function includes a zero, this can also change the step response.

\begin{example} 
Again, consider the nominal system
\[
G_{\rm nom}(s) = \frac{2}{s^{2}+2s +2}.
\]
We compare the step response of this system with the step response of the following two systems 
\[
G_{1}(s) = \frac{(s+2)}{(s^{2}+2s +2)} \quad G_{2}(s) = \frac{0.2(s+10)}{(s^{2}+2s +2)}
\]
These three systems all have complex poles at $s=-1\pm j$. The ``nominal'' system has no zero, while $G_{1}$ has a zero at $s=-2$ and $G_{2}$ has a zero at $s=-10$. The pole zero diagram for $G_{1}(s)$ and $G_{2}(s)$ are shown, along with the comparison of the step response to the nominal second order system.
\begin{frame}{Effect of extra zero on step response}
\begin{center}
\input{Graphics/extrazero.tex}
\end{center}
\end{frame}

\end{example}
In this case, the effect of a zero is to make the response faster and more oscillatory, but this effect is reduced as the zero moves to the left on the complex plane. We have the following rule of thumb:
\begin{center}
\framebox{Extra zeros can be discarded if they are $\geq$ 10$\times$ the real part of the dominant poles}
\end{center}

\subsection{Approximation using dominant poles}

If we suspect that a higher order system $G(s)$ can be approximated as a first or second order system without zeros, then we can try to form an explicit expression for this approximation. Given a transfer function $G(s)$, with either a single or complex conjugate pair of dominant poles, we can postulate an approximation of the form
\[
G_{\rm approx}(s) = \frac{K}{s+\sigma}
\]
for a first order dominant pole at $s=-\sigma$, or
\[
G_{\rm approx}(s)=  \frac{K}{s^{2}+2\zeta\omega_{n} s + \omega_{n}^{2}}
\]
where $\zeta,\omega_{n}$ parameterize the dominant poles. What remains to be chosen is $K$ . With one parameter, we can make sure that our approximation is an equality for a particular value of $s$. A good choice is to ensure that we have an equality at $s=0$. That is, we find the $K$ such that 
\[
G_{\rm approx}(0) = G(0)
\]
Later, when we introduce the frequency response of a system, we will see that this ensures that the DC gain of our approximation is the same as the DC gain of the actual system.

\begin{example} Determine if the following system can be approximated as a second order system, and if so, find the approximation
\[
G(s) = \frac{s+20}{(s^{2}+3s+5)(s+15)}
\]
The second order term has poles at $s=-1.5\pm j1.66$, which has real part $-1.5$, and are the closest poles to the $j\omega$ axis, and thus are the dominant poles. Since the pole at $s=-15$ and the zero at $s=-20$ have real part greater than 10 times the real part of the dominant poles, this system can be approximated as second order. We will use the approximation
\[
G_{\rm approx}(s) =  K\frac{5}{s^{2}+3s+5}
\]
Since
\[
G(0) = \frac{20}{5(15)}
\]
and
\[
G_{\rm approx}(0) =  K
\]
we choose $K$ to make them equal
\[
K = \frac{20}{5(15)} = \frac{4}{15} .
\]
The approximation is then
\[
G_{\rm approx}(s) =  4/15\frac{5}{s^{2}+3s+5}.
\]
\end{example}




\section{Performance Regions for Dominant Poles}

Performance specifications can be transformed into a desired location for dominant poles. Suppose we have the following specifications:

\begin{itemize}
\item Rise time $\leq  \overline{\tr}$
\item Settling time $\leq  \overline{\ts}$
\item Overshoot $\leq \overline{\OS}$. 
\end{itemize}

From our specification equations, this implies the following constraints on $\zeta$ and $\omega_{n}$
\begin{itemize}
\item Rise time
\[
\tr = \treqtwo \leq  \overline{\tr} \quad \rightarrow \quad {\color{green} \omega_{n}} \geq \frac{2.2}{ \overline{\tr}} 
\]
\item Settling time
\[
\ts = \tseqtwo \leq  \overline{\ts} \quad \rightarrow \quad {\color{red} \zeta\omega_{n} } \geq \frac{4.6}{ \overline{\ts}} 
\]
\item Overshoot
\[
\OS = \OSeq \leq \overline{\OS} \quad \rightarrow \quad {\color{blue} \zeta} \geq \frac{-\ln(\overline{\OS}/100)}{\sqrt{ \ln(\overline{\OS}/100)^{2} + \pi^{2}}}
\]

\end{itemize}

Now, recall the pole map for under-damped poles.
\begin{frame}{Under-damped poles in the complex plane}
\begin{center}
\input{Graphics/underdampedpoles.tex}
\end{center}
\end{frame}

Each of these specifications places a geometric constraint on the location of the pole locations.

\begin{itemize}
\item Rise time constraints: Since $\omega_{n}$ corresponds to the distance of the poles to the origin, to meet a specific rise time constraint requires keeping the poles outside of a semi-circle.

\begin{frame}{Rise Time Constraint}
\begin{center}
\input{Graphics/risetimeconstraint.tex}
\end{center}
\end{frame}

\item Settling time constraints: Since $\sigma=\zeta\omega_{n}$ corresponds to the real part of the poles, to meet a specific settling time constraint requires keeping the poles to the left of a vertical line.

\begin{frame}{Settling Time Constraint}
\begin{center}
\input{Graphics/settlingtimeconstraint.tex}
\end{center}
\end{frame}

\item Overshoot constraints: Since $\zeta$ corresponds to the angle the pole makes with the real axis, to meet a specific percent overshoot constraint requires keeping the poles inside two angled lines.

\begin{frame}{Overshoot Constraint}
\begin{center}
\input{Graphics/overshootconstraint.tex}
\end{center}
\end{frame}
\end{itemize}

\section{Application Example}
\noindent Compared to the transfer function given in the Lecture \FirstOrderResponseNumber: \FirstOrderResponseShortName \ Application Example, a more realistic description of the relationship between the wind speed \(u\) and a wind turbine's rotational speed \(\omega\) is given by the 3\textsuperscript{rd}-order transfer function

\begin{equation*}
	\frac{\omega (s)}{u(s)} = \frac{0.54435(s^2+0.09341s+6.511)}{(s+0.2867)(s^2+0.2996s+6.477)}
\end{equation*}

\noindent How do you expect the step response to change for this 3\textsuperscript{rd} order model compared to the original 1\textsuperscript{st}  order model? \\

\noindent Start by defining the two transfer functions and comparing the pole-zero maps:\\

\noindent \texttt{>> gs1 = tf([0.5472],[1 0.2867])}\\
\texttt{>> gs3 = tf(0.54435, [1 0.2867])*tf([1 0.09341 6.511],[1 0.2996 6.477])}\\
\texttt{>> figure}\\
\texttt{>> subplot 121; pzmap(gs1)}\\
\texttt{>> subplot 122; pzmap(gs3)}

\textsc{Matlab} produces Figure \ref{fig:pzmaps}. The 3\textsuperscript{rd} order system (right plot) has two additional complex poles and two additional complex zeros compared to the 1\textsuperscript{st} order system. The complex poles have real parts closer to the origin compared to the real pole, so they are dominant.

\begin{center}
	\begin{figure}
		\includegraphics[width=6in]{figures/poleZeroMaps.png}\\
		\caption{Pole-zero maps for first order (left) and third order (right) wind turbine models.}
		\label{fig:pzmaps}
	\end{figure}
\end{center}


Comparing the turbine's dominant pair of complex poles to our standard 2\textsuperscript{nd}-order form
\begin{equation*}
	s^2 + 0.2996s + 6.477 = s^2 + 2\zeta \omega_n s + \omega_n^2
\end{equation*}

\noindent we find that \(\omega_n\) = 2.55 and \(\zeta\) = 0.118. This value of damping is small, so we expect to see some oscillations in the step response.
Let's check our hypothesis using the step command:\\
\texttt{>> step(gs1,gs3)}\\
\noindent which results in Figure \ref{fig:stepresp}, where the two plots look nearly identical when zoomed out (left plot) but the oscillations appear after zooming in (right plot).
\begin{center}
	\begin{figure}
	\includegraphics[width = 6.5in]{figures/stepResponse.png}\\
	\caption{Step response from changes in wind speed (m/s) to changes in rotor speed (rpm) for 1\textsuperscript{st} and 3\textsuperscript{rd} order wind turbine models. The right plot is a zoomed in version of the left to show oscillations.}
	\label{fig:stepresp}
	\end{figure}
\end{center}

\noindent \underline{\textbf{Challenge:}} Are these oscillations what we expect given the pole locations?\\

Given the relationship between damping ratio z and percent overshoot
\begin{equation*}
	\%OS = e^{\frac{-\zeta \pi}{\sqrt{1-\zeta^2}}} \approx 69\%
\end{equation*}
we expect a much higher overshoot than we actually observe. What else may be impacting the response? (Hint: what parts of the 3\textsuperscript{rd}-order transfer function have we not yet analyzed?)


\section{Lecture Highlights}
The primary takeaways from this article include
\begin{enumerate}
\setlength{\itemsep}{5pt}
\setlength{\parskip}{0pt}
\setlength{\parsep}{0pt}
\item This lecture builds upon the First and Second Order Response lectures by providing you with the tools to predict the transient behavior (rise time, settling time, and percent overshoot) based on the dominant pole or poles.
\item Extra poles and zeros will affect the system's transient behavior in ways that are difficult to quantify by hand, but the affect is small if these extra poles and zeros are at least ten times further from the imaginary axis than the dominant pole(s).
\item In addition to using dominant pole theory to predict a system's transient response, we can also use it to design controllers to achieve a desired response. To do so, we map \textit{allowable dominant pole locations} in the complex plane as follows:
\begin{enumerate}
\setlength{\itemsep}{5pt}
\setlength{\parskip}{0pt}
\setlength{\parsep}{0pt}
\item For a rise time specification, the boundary of the allowable dominant pole location(s) is a semicircle with radius $\omega_n$.
\item For a settling time specification, the boundary of the allowable dominant pole location(s) is a line parallel to the imaginary axis and intersecting the real axis at $-\sigma = -\zeta \omega_n$.
\item For a percent overshoot specification, the boundaries of the allowable dominant pole locations are two complex conjugate lines beginning at the origin and having an angle of $\pm cos^{-1} \zeta$ to the negative real axis.
\end{enumerate}
\end{enumerate}


\section{Quiz Yourself}

\subsection{Questions}


\begin{enumerate}
\setlength{\itemsep}{5pt}
\setlength{\parskip}{0pt}
\setlength{\parsep}{0pt}
\item Suppose a system is described by the second order transfer function
\[
\frac{Y(s)}{R(s)} = \frac{\omega_{n}^{2}}{s^{2}+2\zeta\omega_{n}s+\omega_{n}^2}
\]
Sketch the allowable region in the complex plane for the system poles in order to achieve the following step response specifications:
\begin{itemize}
\setlength{\itemsep}{0pt}
\setlength{\parskip}{0pt}
\setlength{\parsep}{0pt}
\item \% Overshoot $< 20$\%
\item 1\% settling time $< 2$s 
\item rise time $< 1$s
\end{itemize} 
\item Determine if the following system can be approximated as a second order system with no zeros, and if so, what is the approximate system
\[
G(s) = \frac{s+20}{(s+10)(s^{2}+2s+3)}
\]
\item Determine if the following systems can be approximated by either a 1st or 2nd order system without zeros, and if so, find the approximation
\begin{enumerate}
\item $G(s) =\frac{(s+5)}{(s+.1)(s^{2}+2s+2)}$
\item $G(s) =\frac{(s^2+2s+2)}{(s+1)(s^2+5s+10)}$
\item $G(s) =\frac{(s^2+2s+2)}{(s+1)(s^2+20s+100)}$
\end{enumerate}
\end{enumerate}


\subsection{Solutions}
\begin{enumerate}
\setlength{\itemsep}{5pt}
\setlength{\parskip}{0pt}
\setlength{\parsep}{0pt}
\item \rule{0pt}{12pt}\\
\begin{center}
\includegraphics[width=5in]{quizfigures/1soln}\\
\end{center}\pagebreak
\item \rule{0pt}{12pt}\\
\begin{center}
\includegraphics[width=5in]{quizfigures/2asoln}\\
\includegraphics[width=5in]{quizfigures/2bsoln}\\
\end{center}
\item \rule{0pt}{12pt}\\
\includegraphics[width=5in]{quizfigures/3asoln}\\
(b)\\
\includegraphics[width=5in]{quizfigures/3bsoln}\\
(c)\\
\includegraphics[width=5in]{quizfigures/3csoln}
\end{enumerate}

\section{Resources}

\subsection{Books}


\begin{itemize}
\item Norman S. Nise, {\em Control Systems Engineering}, Wiley
\begin{itemize}
\item 7th edition: Sections 4.7-4.8
\end{itemize}
\item Richard C. Dorf and Robert H. Bishop, {\em Modern Control Systems}, Pearson
\begin{itemize}
\item 13th edition: Section 5.4
\end{itemize}
\item Gene F. Franklin, J. David Powell and Abbas Emami-Naeini,  {\em Feedback Control of Dynamic Systems}, Pearson
\begin{itemize}
\item 6th and 7th edition: Section 3.5
\end{itemize}
\end{itemize}


\subsection{Web resources}

\begin{itemize}
\item \url{https://www.youtube.com/watch?v=uHRKQMMylFk&list=PL35E85B883E1B5976&index=28}: A 13 minute video covering order reduction
\end{itemize}




\end{document}


